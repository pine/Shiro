machine:
  ruby:
    version: 2.2.2

dependencies:
  pre:
    - .circle/install-crenv.bash
    - crenv --version
    - .circle/install-crystal.bash
    - crystal --version

  override:
    - crystal deps

  cache_directories:
    - .crystal
    - .deps
    - ~/.crenv

test:
  override:
    - crystal spec

deployment:
  production:
    branch: master
    commands:
      - make
      - git push ssh://55ec5d8289f5cf2415000070@shiro-pinemz.rhcloud.com/~/git/shiro.git/ master
      - rsync -avzhe ssh ./bin/ 55ec5d8289f5cf2415000070@shiro-pinemz.rhcloud.com:/var/lib/openshift/55ec5d8289f5cf2415000070/app-root/repo/bin/
